title: Azure B2C – Crypto Misuse and Account Compromise
slug: azure-b2c-crypto-misuse
cves: null
affectedPlatforms:
- Azure
affectedServices:
- Azure Active Directory B2C
image: https://www.praetorian.com/wp-content/uploads/2023/02/AzureB2C1.png
severity: high
piercingIndexVector: {version: 1.5, A1: 20, A2: 1, etc.} (optional)
discoveredBy:
  name: John Novak
  org: Praetorian
  domain: https://www.praetorian.com
  twitter: @jwnovak
publishedAt: 2023/02/15
disclosedAt: 2023/02/15
exploitabilityPeriod: Unknown, but likely 2021 or earlier until 12/2022
knownITWExploitation: false
summary: |
  Microsoft’s Azure Active Directory B2C service contained a cryptographic flaw which allowed an attacker to craft an OAuth refresh token with the contents for any user account.
  An attacker could redeem this refresh token for a session token, thereby gaining access to a victim account as if the attacker had logged in through a legitimate login flow.
manualRemediation: |
  None required, but it is recommended B2C tenant administrators perform a key rotation and/or switch to symmetric cryptography
detectionMethods: null
contributor: https://github.com/jnovak-praetorian
references:
- https://www.praetorian.com/blog/azure-b2c-crypto-misuse-and-account-compromise/
